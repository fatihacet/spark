<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Spark Framework Source: ajax/ajax.js</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.dark.css">

	<link type="text/css" rel="stylesheet" href="styles/site.spacelab.css">

</head>

<body>
<div class="container-fluid">
	<div class="navbar navbar-fixed-top ">
		<div class="navbar-inner">
			<a class="brand" href="index.html">Spark Framework</a>
			<ul class="nav">
				
				<li class="dropdown">
					<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b
						class="caret"></b></a>

					<ul class="dropdown-menu inline">
						
						<li>
							<a href="spark.components.Button.html">spark.components.Button</a>
						</li>
						
						<li>
							<a href="spark.components.Checkbox.html">spark.components.Checkbox</a>
						</li>
						
						<li>
							<a href="spark.components.ComboBox.html">spark.components.ComboBox</a>
						</li>
						
						<li>
							<a href="spark.components.DraggableView.html">spark.components.DraggableView</a>
						</li>
						
						<li>
							<a href="spark.components.Field.html">spark.components.Field</a>
						</li>
						
						<li>
							<a href="spark.components.Form.html">spark.components.Form</a>
						</li>
						
						<li>
							<a href="spark.components.Input.html">spark.components.Input</a>
						</li>
						
						<li>
							<a href="spark.components.Label.html">spark.components.Label</a>
						</li>
						
						<li>
							<a href="spark.components.LabeledInput.html">spark.components.LabeledInput</a>
						</li>
						
						<li>
							<a href="spark.components.Modal.html">spark.components.Modal</a>
						</li>
						
						<li>
							<a href="spark.components.Overlay.html">spark.components.Overlay</a>
						</li>
						
						<li>
							<a href="spark.components.Password.html">spark.components.Password</a>
						</li>
						
						<li>
							<a href="spark.components.Radio.html">spark.components.Radio</a>
						</li>
						
						<li>
							<a href="spark.components.Textarea.html">spark.components.Textarea</a>
						</li>
						
						<li>
							<a href="spark.components.TextareaWithCharCounter.html">spark.components.TextareaWithCharCounter</a>
						</li>
						
						<li>
							<a href="spark.components.ToggleSwitch.html">spark.components.ToggleSwitch</a>
						</li>
						
						<li>
							<a href="spark.core.HistoryManager.html">spark.core.HistoryManager</a>
						</li>
						
						<li>
							<a href="spark.core.HistoryManager.TokenTransformer.html">spark.core.HistoryManager.TokenTransformer</a>
						</li>
						
						<li>
							<a href="spark.core.Object.html">spark.core.Object</a>
						</li>
						
						<li>
							<a href="spark.core.RemoteStore.html">spark.core.RemoteStore</a>
						</li>
						
						<li>
							<a href="spark.core.Router.html">spark.core.Router</a>
						</li>
						
						<li>
							<a href="spark.core.Store.html">spark.core.Store</a>
						</li>
						
						<li>
							<a href="spark.core.View.html">spark.core.View</a>
						</li>
						
						<li>
							<a href="spark.widgets.SignUp.html">spark.widgets.SignUp</a>
						</li>
						

					</ul>
				</li>
				
			</ul>
		</div>
	</div>

	<div class="row-fluid">

		
			<div class="span12">
				
				<div id="main">
					


		<h1 class="page-title">Source: ajax/ajax.js</h1>
    
<section>
	<article>
		<pre
			class="sunlight-highlight-javascript linenums">// Generated by github.com/steida/coffee2closure 0.1.9
goog.provide('spark.ajax');
goog.require('goog.net.XhrIo');
goog.require('goog.Uri');

/**
  Ajax request manager of Spark Framework. API is almost the same with jQuery's
  `$.ajax`. This means in most cases, changing `$.ajax` to `spark.ajax.request`
  would work.

  Your `options` object may contain `type`, `url`, `data`, `success`, `error`
  like keys to customize your Ajax request as would be in jQuery's `$.ajax`.

  The request method tries to be clever enough. If your response's content type
  header is `'application/json'` it will parse the response to be a JSON.
  Otherwise it won't touch the response. If your response header misses the
  correct content type header for JSON and you are sure that the response is a
  valid JSON, you are free to use `dataType: 'json'` in your options object to
  parse your data as JSON.

  To post data with request method put your data into `options.data`. If your
  method is GET post data will be appended end of the URL as query string.
  Otherwise it will be posted as `application/json`.

  Here is a sample Ajax request in Spark Framework.

  ```coffee
    spark.ajax.request
      type     : 'POST'
      url      : 'http://reqr.es/api/users/12'
      data     : name: 'fatih'
      dataType : 'json' # optional if the JSON response header set.
      success  : (response) -> console.log response.data.first_name
      error    : -> console.log 'error'
  ```

  @export
  @param {Object=} options Options object to configure the Ajax request.
  @this {Object}
 */
spark.ajax.request = function(options) {
  var callbackWrapper, data, dataType, error, headers, key, success, type, url, value;
  options = spark.ajax.getOptions_(options);
  type = options.type, url = options.url, data = options.data, dataType = options.dataType, success = options.success, error = options.error;
  if (data && spark.validation.isObject(data)) {
    if (type === spark.ajax.RequestTypes.GET) {
      url = new goog.Uri(url);
      for (key in data) {
        value = data[key];
        url.setParameterValue(key, value);
      }
      url = url.toString();
    } else {
      try {
        data = JSON.stringify(data);
        headers = {
          'Content-Type': 'application/json; charset=UTF-8'
        };
      } catch (_error) {}
    }
  }
  callbackWrapper = (function(_this) {
    return function(e) {
      var contentType, hasJSONHeader, isDataTypeJSON, isJSON, reqError, response, target;
      target = e.target;
      reqError = target.getLastError();
      if (reqError) {
        return error(reqError, e);
      }
      contentType = target.getResponseHeader(goog.net.XhrIo.CONTENT_TYPE_HEADER);
      hasJSONHeader = (contentType != null ? contentType.indexOf('application/json') : void 0) > -1;
      isDataTypeJSON = (dataType != null ? dataType.toLowerCase() : void 0) === 'json';
      isJSON = hasJSONHeader || isDataTypeJSON;
      response = isJSON ? target.getResponseJson() : target.getResponse();
      return success(response, e);
    };
  })(this);
  return goog.net.XhrIo.send(url, callbackWrapper, type, data, headers);
};

/**
  Returns default options for spark.ajax.request method.

  @private
  @param {Object=} options Config object.
  @return {Object} Final object fallbacked with defaults.
 */
spark.ajax.getOptions_ = function(options) {
  if (options == null) {
    options = {};
  }
  options = {
    type: options.type || (options.type = options['type'] || spark.ajax.RequestTypes.GET),
    url: options.url || (options.url = options['url'] || ''),
    data: options.data || (options.data = options['data'] || null),
    dataType: options.dataType || (options.dataType = options['dataType'] || null),
    success: options.success || (options.success = options['success'] || function() {}),
    error: options.error || (options.error = options['error'] || function() {})
  };
  return options;
};

/**
  HTTP request methods map as enum.

  @enum {string}
  @export
 */
spark.ajax.RequestTypes = {
  GET: 'GET',
  POST: 'POST',
  PUT: 'PUT',
  DELETE: 'DELETE'
};</pre>
	</article>
</section>





				</div>

				<div class="clearfix"></div>
				<footer>
					
					Spark Framework by Fatih Acet <fatih@fatihacet.com>
					<br />
					
					
		<span class="copyright">
		Copyright Â© 2014 - Fatih Acet
		</span>
					<br />
					
		<span class="jsdoc-message">
		Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.2</a>
		on 2015-02-11T17:49:10+00:00 using the <a
			href="https://github.com/terryweiss/docstrap">DocStrap template</a>.
		</span>
				</footer>
			</div>

			
			<br clear="both">
		</div>

	</div>
	<!--<script src="scripts/sunlight.js"></script>-->
	<script src="scripts/docstrap.lib.js"></script>
	<script src="scripts/bootstrap-dropdown.js"></script>
	<script src="scripts/toc.js"></script>

	<script>
		$( function () {
			$( "[id*='$']" ).each( function () {
				var $this = $( this );

				$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
			} );

			$( "#toc" ).toc( {
				anchorName  : function ( i, heading, prefix ) {
					return $( heading ).attr( "id" ) || ( prefix + i );
				},
				selectors   : "h1,h2,h3,h4",
				showAndHide : false,
				scrollTo    : "100px"
			} );

			$( "#toc>ul" ).addClass( "nav nav-pills nav-stacked" );
			$( "#main span[id^='toc']" ).addClass( "toc-shim" );
			$( '.dropdown-toggle' ).dropdown();
//			$( ".tutorial-section pre, .readme-section pre" ).addClass( "sunlight-highlight-javascript" ).addClass( "linenums" );

			$( ".tutorial-section pre, .readme-section pre" ).each( function () {
				var $this = $( this );

				var example = $this.find( "code" );
				exampleText = example.html();
				var lang = /{@lang (.*?)}/.exec( exampleText );
				if ( lang && lang[1] ) {
					exampleText = exampleText.replace( lang[0], "" );
					example.html( exampleText );
					lang = lang[1];
				} else {
					lang = "javascript";
				}

				if ( lang ) {

					$this
						.addClass( "sunlight-highlight-" + lang )
						.addClass( "linenums" )
						.html( example.html() );

				}
			} );

			Sunlight.highlightAll( {
				lineNumbers : true,
				showMenu : true,
				enableDoclinks : true
			} );
		} );
	 </script>



	<!--Navigation and Symbol Display-->
	


	<!--Google Analytics-->
	

</body>
</html>
